
\definecolor{Matterhorn}{RGB}{70,45,68}
\definecolor{Cowboy}{RGB}{86,47,50}

\definecolor{RegalBlue}{RGB}{3,69,117}
\definecolor{RedDevil}{RGB}{134,1,17}

\definecolor{IdiotPurple}{RGB}{102, 51, 102}
\definecolor{FernGreen}{HTML}{467D5E}
\definecolor{ThroneBlue}{RGB}{51, 51, 102}
\definecolor{PermaRed}{RGB}{255, 102, 102}
\definecolor{DogwoodRose}{HTML}{cc3366}
\definecolor{MaizeCrayola}{RGB}{255, 204, 102}
\definecolor{Black}{RGB}{0, 0, 0}

\def\ProgColor{Cowboy}

% \Progparens{M} yields parentheses with program color
\NewDocumentCommand{\Progparens}{m}{{\textcolor{\ProgColor}{(}}#1{\textcolor{\ProgColor}{)}}}

\NewDocumentCommand{\IfProgparens}{mm}{\IfBooleanTF{#1}{\Progparens{#2}}{#2}}

\NewDocumentCommand{\Prog}{m}{{\textcolor{\ProgColor}{#1}}}
\NewDocumentCommand{\Progsf}{m}{{\Prog{\textsf{#1}}}}

% star version of \IsProg gives alignment before \vdash
\NewDocumentCommand{\IsProg}{smmm}{\Type{#2} \IfBooleanTF{#1}{&}{} \vdash \Prog{#3} : \Type{#4}}

% \bra* for types
% \bra for terms
\NewDocumentCommand{\bra}{som}{
  \textcolor{Black}{\llbracket}
    \IfBooleanTF{#1}{#3}{\Prog{#3}}
  \textcolor{Black}{\rrbracket}
    \IfNoValueF{#2}{_\Name{#2}}
}

\DeclarePairedDelimiter\sem{\llbracket}{\rrbracket}
\NewDocumentCommand{\Trans}{mo}{
  \sem*{#1}\IfNoValueF{#2}{_\Name{#2}}
}

% types
\NewDocumentCommand{\unit}{}{\textsf{unit}}

\NewDocumentCommand{\send}{}{\textrm{!}}
\NewDocumentCommand{\recv}{}{\textrm{?}}

\NewDocumentCommand{\Lam}{smm}{\Prog{\lambda \Name{#2}.\,\IfProgparens{#1}{#3}}}
\NewDocumentCommand{\Jux}{mm}{\Prog{#1 #2}}
\NewDocumentCommand{\Pair}{mm}{\Prog{(#1, #2)}}
\NewDocumentCommand{\Let}{mm}{\Prog{\textsf{let} \; \Name{#1} \; = \;  \Prog{#2} \; \textsf{in}}}
\NewDocumentCommand{\LetP}{mmm}{\Let{\Pair{\Name{#1}}{\Name{#2}}}{#3}}
\NewDocumentCommand{\Send}{smm}{\IfProgparens{#1}{\Prog{\textsf{send} \; #2 \; #3}}}
\NewDocumentCommand{\Recv}{sm}{\IfProgparens{#1}{\Prog{\textsf{recv} \; #2}}}
\NewDocumentCommand{\Conn}{mmmm}{\Prog{\textsf{connect}(\Name{#1}.\, #2; \Name{#3}.\, #4)}}
\NewDocumentCommand{\Term}{sm}{\Prog{\textsf{terminate} \; \IfProgparens{#1}{#2}}}
\NewDocumentCommand{\Unit}{}{\Prog{\star}}
\NewDocumentCommand{\Left}{sm}{\IfProgparens{#1}{\Prog{\textsf{inl} \; #2}}}
\NewDocumentCommand{\Right}{sm}{\IfProgparens{#1}{\Prog{\textsf{inr} \; #2}}}
\NewDocumentCommand{\Match}{mmmm}{\Prog{\textsf{match} \; #1 \; \textsf{with} \; \Name{#2}.\{ #3, #4\}}}
\NewDocumentCommand{\SelectL}{sm}{\Prog{\IfProgparens{#1}{\textsf{select}_{L} \; #2}}}
\NewDocumentCommand{\SelectR}{sm}{\Prog{\IfProgparens{#1}{\textsf{select}_{R} \; #2}}}
\NewDocumentCommand{\SCase}{smmmm}{\Prog{\textsf{case} \; #2 \; \textsf{of} \; \Name{#3}.\{#4,#5\}}}
\NewDocumentCommand{\IfThen}{m}{\Deriv{\textsf{if} \; \Prog{#1} \; \textsf{then}}}
\NewDocumentCommand{\Else}{}{\Deriv{\textsf{else}}}

\NewDocumentCommand{\endm}{}{\textsf{end}_!}
\NewDocumentCommand{\endp}{}{\textsf{end}_?}


\NewDocumentCommand{\boo}{}{\Type{\mathbb{B}}}
\NewDocumentCommand{\True}{}{\Deriv{\textsf{tt}}}
\NewDocumentCommand{\False}{}{\Deriv{\textsf{ff}}}

\NewDocumentCommand{\nat}{}{\Type{\mathbb{N}}}
\NewDocumentCommand{\Zero}{}{\Namesf{zero}}
\NewDocumentCommand{\Succ}{}{\Namesf{succ}}

\NewDocumentCommand{\Serv}{smmmmmm}{
  \IfBooleanTF{#1}{
  \Deriv{
    \textsf{serve'} \; \Name{#2} \{ \Prog{#3}, \Name{#4}.\, \Prog{#5}, \Name{#6}.\, \Prog{#7}  \}
  }
}{
  \Prog{
    \textsf{serve} \; \Name{#2} \{ \Prog{#3}, \Name{#4}.\, \Prog{#5}, \Name{#6}.\, \Prog{#7}  \}
  }
}
}

\NewDocumentCommand{\Inv}{mm}{
  \Deriv{\textsf{inv}_{\Name{#1}}(\Prog{#2})}
}

\NewDocumentCommand{\ForkJoin}{mmmm}{
\Deriv{\textsf{fork-join}(\Prog{#1}, \Prog{#2}, \Prog{#3}, \Prog{#4)}}
}

\NewDocumentCommand{\ReqA}{smmm}{
  \Prog{\textsf{fork}_{\Name{#2}} \; \Name{#3}.\, \IfProgparens{#1}{\Prog{#4}}}
}
\NewDocumentCommand{\ReqW}{m}{
  \Prog{\textsf{eof}_\Name{#1}}
}

